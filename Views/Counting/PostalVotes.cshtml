@model SEMS.Models.Counting.VotesModel
@{
    ViewData["Title"] = "PostalVotes";
    Layout = "~/Views/Shared/_Layout.cshtml";
@using System.Data;
    DataSet constTypes = ViewBag.constTypes, districts = ViewBag.districts, tehsils = ViewBag.tehsils;
    DataSet panchayats = ViewBag.panchayats, pollingStations = ViewBag.pollingStations, constituencies = ViewBag.constituencies;
}
<script>
    
    function SubmitForm(item)
    {
        var pc = item.id;
        document.getElementById("hidPostCause").value = pc;
        document.getElementById('frmPostalVotes').submit();
    }
</script>
<form id="frmPostalVotes" method="post">
    <input type="hidden" id="hidPostCause" asp-for="postCause" />
    <div class="container">
        <h2 class="pageheading">Postal Votes Entry</h2>
        <div class="row">
            <hr />
            <div class="col-sm-3" style="text-align:right;font-weight:bold;color:maroon;">
                Constituency Selection
            </div>
            <div class="col-sm-3">
                <input type="radio" value="A" id="radAuto" name="mode" asp-for="mode" checked onchange="SubmitForm(this);"/>
                <label class="form-label mylabel" for="radAuto">By Constituency No.</label>
            </div>
            <div class="col-sm-3">
                <input type="radio" value="M" id="radManual" name="mode" asp-for="mode" onchange="SubmitForm(this);" />
                <label class="form-label mylabel" for="radManual">Manually Select</label>
            </div>
            <hr />
        </div>
        @{
            List<SelectListItem> items = new List<SelectListItem>();
        }
        <div class="row">
            <div class="col-sm-4">
                <label class="form-label mylabel" for="divConstType" >Constituency Type</label>
                @{
                    foreach (DataRow row in constTypes.Tables[0].Rows)
                    {
                        SelectListItem s = new SelectListItem();
                        s.Text = row["TYPE_NAME"].ToString();
                        s.Value = row["TYPE_CODE"].ToString();
                        items.Add(s);
                    }
                }
                <select class="form-select mycontrol" id="divConstType" asp-for="constType" asp-items="@items" onchange="SubmitForm(this);"></select>
            </div>
            <div class="col-sm-4" id="divDistrict">
                @{
                    items.Clear();
                    foreach (DataRow row in districts.Tables[0].Rows)
                    {
                        SelectListItem s = new SelectListItem();
                        s.Text = row["DIST_NAME"].ToString();
                        s.Value = row["DIST_CODE"].ToString();
                        items.Add(s);
                    }
                }
                <label class="form-label mylabel" for="divDistrict">District</label>
                <select class="form-select mycontrol" id="divDistrict" asp-for="district" asp-items="@items" onchange="SubmitForm(this);"></select>
            </div>
            <div class="col-sm-4" id="divTehsil">
                @{
                    items.Clear();
                    foreach (DataRow row in tehsils.Tables[0].Rows)
                    {
                        SelectListItem s = new SelectListItem();
                        s.Text = row["TNAME"].ToString();
                        s.Value = row["TCODE"].ToString();
                        items.Add(s);
                    }
                }
                <label class="form-label mylabel" for="divTehsil">Tehsil</label>
                <select class="form-select mycontrol" id="divTehsil" asp-for="tehsil" asp-items="@items" onchange="SubmitForm(this);"></select>
            </div>
            <div class="col-sm-4" id="divPanchayat">
                @{
                    items.Clear();
                    foreach (DataRow row in panchayats.Tables[0].Rows)
                    {
                        SelectListItem s = new SelectListItem();
                        s.Text = row["PAN_NAME"].ToString();
                        s.Value = row["PNO"].ToString();
                        items.Add(s);
                    }
                }
                <label class="form-label mylabel" for="divPanchayat">Panchayat</label>
                <select class="form-select mycontrol" id="divPanchayat" asp-for="panchayat" asp-items="@items" onchange="SubmitForm(this);"></select>
            </div>
            <div class="col-sm-4" id="divConstituency">
                @{
                    items.Clear();
                    foreach (DataRow row in constituencies.Tables[0].Rows)
                    {
                        SelectListItem s = new SelectListItem();
                        s.Text = row["CONST_NAME"].ToString();
                        s.Value = row["CONST_CODE"].ToString();
                        items.Add(s);
                    }
                }
                <label class="form-label mylabel" for="divConstituency">Constituency</label>
                <select class="form-select mycontrol" asp-for="constName" asp-items="@items" onchange="SubmitForm(this);"></select>
            </div>
            <div class="col-sm-4" id="divPS">
                @{
                    items.Clear();
                    foreach (DataRow row in pollingStations.Tables[0].Rows)
                    {
                        SelectListItem s = new SelectListItem();
                        s.Text = row["PS_NAME"].ToString();
                        s.Value = row["PSCODE"].ToString();
                        items.Add(s);
                    }
                }
                <label class="form-label mylabel" for="divPS">Polling Station</label>
                <select class="form-select mycontrol" asp-for="pollingStation" asp-items="@items"></select>
            </div>
            <div class="col-sm-2" >
                <label class="form-label mylabel" for="numPS">Polling Station No.</label>
                <input type="number" class="form-control mycontrol" id="numPS" min="1" max="686" style="text-align:center;"  />
            </div>
            <div class="col-sm-2">
               <label class="form-label">.</label><button class="btn btn-danger form-control">Fetch List</button>
            </div>

        </div>
    </div>
    <script>

        var mode = "@Model.mode";
        var constType = "@Model.constType";
        if (mode == 'M') {
            document.getElementById("numPS").disabled = true;
            if (constType == "1") {
                document.getElementById('divDistrict').style.display = "none";
                document.getElementById('divTehsil').style.display = "block";
                document.getElementById('divPanchayat').style.display = "block";
                document.getElementById('divConstituency').style.display = "block";
                document.getElementById('divPS').style.display = "none";
            }
            else if (constType == "2") 
            { 
                document.getElementById('divDistrict').style.display = "none";
                document.getElementById('divTehsil').style.display = "block";
                document.getElementById('divPanchayat').style.display = "none";
                document.getElementById('divConstituency').style.display = "block";
                document.getElementById('divPS').style.display = "block";
            }
            else if (constType == "3") {
                document.getElementById('divDistrict').style.display = "none";
                document.getElementById('divTehsil').style.display = "block";
                document.getElementById('divPanchayat').style.display = "none";
                document.getElementById('divConstituency').style.display = "block";
                document.getElementById('divPS').style.display = "block";
            }
            else if (constType == "4") {
                document.getElementById('divDistrict').style.display = "block";
                document.getElementById('divTehsil').style.display = "none";
                document.getElementById('divPanchayat').style.display = "none";
                document.getElementById('divConstituency').style.display = "block";
                document.getElementById('divPS').style.display = "block";
            }
            else if (constType == "5") {
                document.getElementById('divDistrict').style.display = "none";
                document.getElementById('divTehsil').style.display = "none";
                document.getElementById('divPanchayat').style.display = "none";
                document.getElementById('divConstituency').style.display = "block";
                document.getElementById('divPS').style.display = "block";
            }
        }
        else {
            document.getElementById("numPS").disabled = false;
            document.getElementById('divDistrict').style.display = "none";
            document.getElementById('divTehsil').style.display = "none";
            document.getElementById('divPanchayat').style.display = "none";
            document.getElementById('divConstituency').style.display = "none";
            document.getElementById('divPS').style.display = "none";
        }

    </script>
</form>



